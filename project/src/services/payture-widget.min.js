!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("payture-widget",[],t):"object"==typeof exports?exports["payture-widget"]=t():e.PaytureWidget=t()}(self,(function(){return(()=>{"use strict";var e={483:(e,t,n)=>{var r,o=(r={},function(e){if(void 0===r[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}r[e]=t}return r[e]});e.exports=function(e,t){if((t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},void 0===t.attributes.nonce){var r=n.nc;r&&(t.attributes.nonce=r)}var a=document.createElement("link");if(a.rel="stylesheet",a.href=e,Object.keys(t.attributes).forEach((function(e){a.setAttribute(e,t.attributes[e])})),"function"==typeof t.insert)t.insert(a);else{var i=o(t.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(a)}return function(e){"string"==typeof e?a.href=e:a.parentNode.removeChild(a)}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var r={};return(()=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(r,{default:()=>O});var o=function(e,t,n){return e.hasAttribute(t)&&e.getAttribute(t)===n},a={Key:function(e){return"string"==typeof e},Amount:function(e){return"number"==typeof e&&e>=0},Product:function(e){return void 0===e||"string"==typeof e},Domain:function(e){return void 0===e||"number"==typeof e&&[1,2].includes(e)},Session:function(e){return void 0===e||"string"==typeof e&&("pay"===e.toLowerCase()||"block"===e.toLowerCase())},CustomParams:function(t){return void 0===t||"object"===e(t)},ChequeParams:function(t){if(void 0===t)return!0;if("object"===e(t)){if(null===t)return!0;var n=Array.isArray(t.Positions)&&t.Positions.every((function(e){if(e){var t="string"==typeof e.Text,n="number"==typeof e.Quantity&&e.Quantity>0,r="number"==typeof e.Price&&e.Price>0,o="number"==typeof e.Tax;return t&&n&&r&&o}return!1})),r=void 0===t.CustomerContact||null===t.CustomerContact||"string"==typeof t.CustomerContact,o=void 0===t.Message||null===t.Message||"string"==typeof t.Message;return n&&r&&o}return!1}},i=function(e,t){var n="function"==typeof a[e]&&a[e](t);return n||console.warn("Parameter ".concat(e," (value = ").concat(t,") is not valid. The corresponding default value will be used.")),n};function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.layout={}}var n,r;return n=e,(r=[{key:"open",value:function(){this.layout.$loader&&(this.layout.$loader.style.visibility="hidden"),this.layout.$closeButtonWrapper&&(this.layout.$closeButtonWrapper.style.visibility="visible"),this.layout.$iframe&&(this.layout.$iframe.style.visibility="visible")}},{key:"close",value:function(){this.layout.$wrapper&&(this.layout.$wrapper.style.display="none",this.layout.$wrapper.style.opacity=0),this.layout.$iframe&&(this.layout.$iframe.style.visibility="hidden"),this.layout.$loader&&(this.layout.$loader.style.visibility="visible"),this.layout.$closeButtonWrapper&&(this.layout.$closeButtonWrapper.style.visibility="hidden");var e=document.getElementById("viewport-widget-device-width");e&&document.head.removeChild(e)}},{key:"render",value:function(){var e=document.createElement("div");e.setAttribute("id","payture-widget-wrapper");var n=document.createElement("div");n.setAttribute("id","payture-widget-shadow");var r=document.createElement("div");r.setAttribute("id","payture-widget-layout"),e.appendChild(n),e.appendChild(r);var a=document.createElement("div");a.setAttribute("id","payture-widget-loader");var i=document.createElement("div");i.setAttribute("id","payture-widget-iframe-wrapper");var s=document.createElement("div");s.setAttribute("id","payture-widget-close");var u=document.createElement("div");u.setAttribute("id","payture-widget-close-button"),s.appendChild(u);var c=document.createElement("iframe");if(c.setAttribute("id","payture-widget-iframe"),c.setAttribute("frameborder","0"),c.setAttribute("scrolling","yes"),c.setAttribute("allowfullscreen","true"),i.appendChild(s),i.appendChild(c),r.appendChild(a),r.appendChild(i),document.body.appendChild(e),navigator.userAgent.match(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i)&&!function(){var e,n=function(e,n){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw i}}}}(document.getElementsByTagName("meta"));try{for(n.s();!(e=n.n()).done;){var r=e.value;if(o(r,"name","viewport")&&o(r,"content","width=device-width, initial-scale=1"))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}()){var l=document.createElement("meta");l.setAttribute("id","viewport-widget-device-width"),l.setAttribute("name","viewport"),l.setAttribute("content","width=device-width, initial-scale=1"),document.head.appendChild(l)}return e.style.display="block",e.style.opacity=1,this.layout={$wrapper:e,$loader:a,$closeButtonWrapper:s,$closeButton:u,$iframe:c},this.layout}},{key:"markAsLoaded",value:function(){this.layout.$iframe&&this.layout.$iframe.classList.add("loaded"),this.layout.$closeButtonWrapper&&this.layout.$closeButtonWrapper.classList.add("loaded")}},{key:"destroy",value:function(){if(this.layout.$wrapper)try{document.body.removeChild(this.layout.$wrapper)}catch(e){}}},{key:"bindHandlers",value:function(e){var t=e.onIframeLoad,n=e.onCloseClick;this.layout.$iframe&&(this.layout.$iframe.onload=function(e){"function"==typeof t&&t(e)}),this.layout.$closeButton&&(this.layout.$closeButton.onclick=function(e){"function"==typeof n&&n(e)})}},{key:"setIframeUrl",value:function(e){this.layout.$iframe?this.layout.$iframe.src=e:console.error("Iframe not found")}}])&&s(n.prototype,r),e}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l="https://merchantgateway.payture.com",d=n(483),f=n.n(d);const p=n.p+"styles.widget.css";function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,g(e,t,"set"),n),n}function w(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,g(e,t,"get"))}function g(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}f()(p,{injectType:"linkTag",insert:"head"});var C={occupied:!1,queue:[],detachListener:function(e){if(window.removeEventListener("message",e.action),e.detached=!0,0===this.queue.length)this.occupied=!1;else{var t=this.queue.pop();window.addEventListener("message",t.action)}},attachListener:function(e){this.occupied?this.queue=[e].concat(this.queue):(window.addEventListener("message",e.action),this.occupied=!0)}},P=new WeakMap,k=new WeakMap,T=new WeakMap,S=new WeakMap,E=new WeakMap,A=new WeakMap;const O=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),P.set(this,{writable:!0,value:{Domain:1,Key:"",Amount:0,Product:"",Session:"Pay",CustomParams:{TemplateTag:"Default",Language:"Default"},ChequeParams:null}}),k.set(this,{writable:!0,value:5e3}),T.set(this,{writable:!0,value:!1}),S.set(this,{writable:!0,value:null}),E.set(this,{writable:!0,value:null}),A.set(this,{writable:!0,value:w(this,P)}),b(this,E,(n=function(e){i.onPaymentTemplateResponse(e)},{id:"widget-".concat(Math.random().toString(16).slice(2)),detached:!1,action:n}));var r=this.parseParameters(t),o=r.callbacks,a=r.data;b(this,A,a),this.setCallbacks(o);var i=this;b(this,S,new u),w(this,S).render(),w(this,S).bindHandlers({onIframeLoad:function(){w(i,T)||(i.onLoad(),i.open())},onCloseClick:function(){i.close(),i.cleanTimer=setTimeout((function(){w(i,E).detached||C.detachListener(w(i,E)),i.destroy()}),w(i,k))}}),C.attachListener(w(this,E)),i.load()}var t,n;return t=e,(n=[{key:"onLoad",value:function(){return w(this,S).markAsLoaded()}},{key:"open",value:function(){return w(this,S).open()}},{key:"close",value:function(){return w(this,S).close()}},{key:"destroy",value:function(){return w(this,S).destroy()}},{key:"load",value:function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URL(l);for(var n in e){var r=e[n];switch(c(r)){case"number":case"string":case"boolean":t.searchParams.set(n,r.toString());break;case"object":null!==r&&t.searchParams.set(n,JSON.stringify(r))}}return t}(w(this,A));w(this,S).setIframeUrl(e.toString())}},{key:"onTransactionCompleted",value:function(e){console.log("Transaction completed with Success = ".concat(e))}},{key:"parseParameters",value:function(e){var t=i("CustomParams",e.CustomParams)?m(m({},w(this,P).CustomParams),e.CustomParams||{}):w(this,P).CustomParams,n=w(this,P).ChequeParams;return i("ChequeParams",e.ChequeParams)&&e.ChequeParams&&(n={Positions:e.ChequeParams.Positions,CustomerContact:e.ChequeParams.CustomerContact||"",Message:e.ChequeParams.Message||"Payture Cheque"}),{callbacks:{onTransactionCompleted:"function"==typeof e.OnTransactionCompleted?e.OnTransactionCompleted:null},data:{key:i("Key",e.Key)?e.Key:w(this,P).Key,amount:i("Amount",e.Amount)?e.Amount:w(this,P).Amount,product:i("Product",e.Product)?e.Product:w(this,P).Product,domain:i("Domain",e.Domain)?e.Domain:w(this,P).Domain,session:i("Session",e.Session)?e.Session:w(this,P).Session,customparams:t,chequeparams:n}}}},{key:"setCallbacks",value:function(e){if("function"==typeof e.onTransactionCompleted){var t=e.onTransactionCompleted.bind(this);this.onTransactionCompleted=function(e){t(e)}}}},{key:"handleTransactionCompleted",value:function(e){var t=e.success,n=e.timeout,r=void 0===n?null:n,o=this;b(o,T,!0);var a=function(){o.close(),"function"==typeof o.onTransactionCompleted&&o.onTransactionCompleted(t),w(o,E).detached||C.detachListener(w(o,E)),o.destroy()};r?setTimeout(a,r):a()}},{key:"onPaymentTemplateResponse",value:function(e){var t=this;if("CLOSE_PAYTURE_WIDGET_SUCCESS"===e.data||"CLOSE_PAYTURE_WIDGET_ERROR"===e.data)switch(e.data){case"CLOSE_PAYTURE_WIDGET_SUCCESS":return void t.handleTransactionCompleted({success:!0});case"CLOSE_PAYTURE_WIDGET_ERROR":return void t.handleTransactionCompleted({success:!1});default:return void console.warn("Unknown message type from payment template registered: ",e.data)}if("string"==typeof e.data)try{var n=JSON.parse(e.data);if("string"!=typeof n.method)return void console.warn("Unknown message type from payment template registered: ",e.data);switch(n.method){case"Payture.PaymentSuccess":return void t.handleTransactionCompleted({success:!0,timeout:2e3});case"Payture.PaymentFail":return void t.handleTransactionCompleted({success:!1,timeout:2e3});default:return void console.warn("Unknown message type from payment template registered: ",e.data)}}catch(t){return void console.warn("Unknown message type from payment template registered: ",e.data)}}}])&&v(t.prototype,n),e}()})(),r.default})()}));